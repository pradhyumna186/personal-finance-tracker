<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Finance Tracker - API Tester</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .auth-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            background: white;
        }

        .section h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.3rem;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #495057;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            font-size: 14px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            margin: 5px;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        button:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
        }

        .response-area {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
        }

        .response-area pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .status-success {
            color: #28a745;
            font-weight: bold;
        }

        .status-error {
            color: #dc3545;
            font-weight: bold;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .token-display {
            background: #e9ecef;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            word-break: break-all;
            font-family: monospace;
            font-size: 12px;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí∞ Personal Finance Tracker</h1>
            <p>API Testing Interface</p>
        </div>

        <div class="content">
            <!-- Authentication Section -->
            <div class="auth-section">
                <h3>üîê Authentication</h3>
                <div class="grid">
                    <div>
                        <h4>Register</h4>
                        <div class="form-group">
                            <label>Email:</label>
                            <input type="email" id="registerEmail" placeholder="user@example.com" required>
                        </div>
                        <div class="form-group">
                            <label>Password:</label>
                            <input type="password" id="registerPassword" placeholder="Test123!@#" required>
                            <small style="color: #666; font-size: 12px;">Must contain uppercase, lowercase, number, and special character</small>
                        </div>
                        <div class="form-group">
                            <label>First Name:</label>
                            <input type="text" id="registerFirstName" placeholder="John" required>
                        </div>
                        <div class="form-group">
                            <label>Last Name:</label>
                            <input type="text" id="registerLastName" placeholder="Doe" required>
                        </div>
                        <div class="form-group">
                            <label>Phone Number (optional):</label>
                            <input type="tel" id="registerPhoneNumber" placeholder="+1-234-567-8900">
                        </div>
                        <div class="form-group">
                            <label>Date of Birth (optional):</label>
                            <input type="date" id="registerDateOfBirth">
                        </div>
                        <div class="form-group">
                            <label>Currency:</label>
                            <select id="registerCurrency">
                                <option value="USD">USD</option>
                                <option value="EUR">EUR</option>
                                <option value="GBP">GBP</option>
                                <option value="CAD">CAD</option>
                                <option value="AUD">AUD</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Time Zone:</label>
                            <select id="registerTimeZone">
                                <option value="UTC">UTC</option>
                                <option value="America/New_York">Eastern Time</option>
                                <option value="America/Chicago">Central Time</option>
                                <option value="America/Denver">Mountain Time</option>
                                <option value="America/Los_Angeles">Pacific Time</option>
                                <option value="Europe/London">London</option>
                                <option value="Europe/Paris">Paris</option>
                                <option value="Asia/Tokyo">Tokyo</option>
                            </select>
                        </div>
                        <button onclick="register()" class="btn-success">Register</button>
                    </div>
                    <div>
                        <h4>Login</h4>
                        <div class="form-group">
                            <label>Email:</label>
                            <input type="email" id="loginEmail" placeholder="user@example.com">
                        </div>
                        <div class="form-group">
                            <label>Password:</label>
                            <input type="password" id="loginPassword" placeholder="password">
                        </div>
                        <button onclick="login()" class="btn-success">Login</button>
                        <button onclick="logout()" class="btn-danger">Logout</button>
                    </div>
                </div>
                <div id="tokenDisplay" class="token-display" style="display: none;">
                    <strong>JWT Token:</strong> <span id="jwtToken"></span>
                </div>
                <div id="authResponse" class="response-area" style="display: none;"></div>
            </div>

            <!-- Health Check -->
            <div class="section">
                <h3>üè• Health Check</h3>
                <button onclick="checkHealth()" class="btn-success">Check Health</button>
                <div id="healthResponse" class="response-area" style="display: none;"></div>
            </div>

            <!-- Categories Section -->
            <div class="section">
                <h3>üìÇ Categories</h3>
                <div class="grid">
                    <div>
                        <h4>Create Category</h4>
                        <div class="form-group">
                            <label>Name:</label>
                            <input type="text" id="categoryName" placeholder="Groceries">
                        </div>
                        <div class="form-group">
                            <label>Description:</label>
                            <textarea id="categoryDescription" placeholder="Food and household items"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Type:</label>
                            <select id="categoryType" required>
                                <option value="">Select Type</option>
                                <option value="INCOME">Income</option>
                                <option value="EXPENSE">Expense</option>
                                <option value="TRANSFER">Transfer</option>
                            </select>
                        </div>
                        <button onclick="createCategory()" class="btn-success">Create Category</button>
                    </div>
                    <div>
                        <h4>Category Operations</h4>
                        <button onclick="getCategories()" class="btn-success">Get All Categories</button>
                        <button onclick="getCategoryById()" class="btn-warning">Get Category by ID</button>
                        <input type="number" id="categoryId" placeholder="Category ID" style="margin-top: 10px;">
                    </div>
                </div>
                <div id="categoryResponse" class="response-area" style="display: none;"></div>
            </div>

            <!-- Accounts Section -->
            <div class="section">
                <h3>üè¶ Accounts</h3>
                <div class="grid">
                    <div>
                        <h4>Create Account</h4>
                        <div class="form-group">
                            <label>Name:</label>
                            <input type="text" id="accountName" placeholder="Main Bank Account">
                        </div>
                        <div class="form-group">
                            <label>Type:</label>
                            <select id="accountType">
                                <option value="CHECKING">Checking</option>
                                <option value="SAVINGS">Savings</option>
                                <option value="CREDIT_CARD">Credit Card</option>
                                <option value="INVESTMENT">Investment</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Balance:</label>
                            <input type="number" id="accountBalance" placeholder="1000.00" step="0.01">
                        </div>
                        <button onclick="createAccount()" class="btn-success">Create Account</button>
                    </div>
                    <div>
                        <h4>Account Operations</h4>
                        <button onclick="getAccounts()" class="btn-success">Get All Accounts</button>
                        <button onclick="getAccountById()" class="btn-warning">Get Account by ID</button>
                        <input type="number" id="accountId" placeholder="Account ID" style="margin-top: 10px;">
                    </div>
                </div>
                <div id="accountResponse" class="response-area" style="display: none;"></div>
            </div>

            <!-- Transactions Section -->
            <div class="section">
                <h3>üí≥ Transactions</h3>
                <div class="grid">
                    <div>
                        <h4>Create Transaction</h4>
                        <div class="form-group">
                            <label>Description:</label>
                            <input type="text" id="transactionDescription" placeholder="Grocery shopping">
                        </div>
                        <div class="form-group">
                            <label>Amount:</label>
                            <input type="number" id="transactionAmount" placeholder="-50.00" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Account ID:</label>
                            <input type="number" id="transactionAccountId" placeholder="1">
                        </div>
                        <div class="form-group">
                            <label>Category ID:</label>
                            <input type="number" id="transactionCategoryId" placeholder="1">
                        </div>
                        <div class="form-group">
                            <label>Type:</label>
                            <select id="transactionType" required>
                                <option value="">Select Type</option>
                                <option value="INCOME">Income</option>
                                <option value="EXPENSE">Expense</option>
                                <option value="TRANSFER">Transfer</option>
                                <option value="ADJUSTMENT">Adjustment</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Date:</label>
                            <input type="datetime-local" id="transactionDate">
                        </div>
                        <button onclick="createTransaction()" class="btn-success">Create Transaction</button>
                    </div>
                    <div>
                        <h4>Transaction Operations</h4>
                        <button onclick="getTransactions()" class="btn-success">Get All Transactions</button>
                        <button onclick="getTransactionById()" class="btn-warning">Get Transaction by ID</button>
                        <button onclick="getTransactionStats()" class="btn-warning">Get Stats</button>
                        <input type="number" id="transactionId" placeholder="Transaction ID" style="margin-top: 10px;">
                    </div>
                </div>
                <div id="transactionResponse" class="response-area" style="display: none;"></div>
            </div>

            <!-- Budgets Section -->
            <div class="section">
                <h3>üìä Budgets</h3>
                <div class="grid">
                    <div>
                        <h4>Create Budget</h4>
                        <div class="form-group">
                            <label>Name:</label>
                            <input type="text" id="budgetName" placeholder="Monthly Groceries">
                        </div>
                        <div class="form-group">
                            <label>Amount:</label>
                            <input type="number" id="budgetAmount" placeholder="500.00" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Category ID:</label>
                            <input type="number" id="budgetCategoryId" placeholder="1">
                        </div>
                        <div class="form-group">
                            <label>Period:</label>
                            <select id="budgetPeriod">
                                <option value="MONTHLY">Monthly</option>
                                <option value="WEEKLY">Weekly</option>
                                <option value="YEARLY">Yearly</option>
                            </select>
                        </div>
                        <button onclick="createBudget()" class="btn-success">Create Budget</button>
                    </div>
                    <div>
                        <h4>Budget Operations</h4>
                        <button onclick="getBudgets()" class="btn-success">Get All Budgets</button>
                        <button onclick="getBudgetById()" class="btn-warning">Get Budget by ID</button>
                        <input type="number" id="budgetId" placeholder="Budget ID" style="margin-top: 10px;">
                    </div>
                </div>
                <div id="budgetResponse" class="response-area" style="display: none;"></div>
            </div>

            <!-- Goals Section -->
            <div class="section">
                <h3>üéØ Goals</h3>
                <div class="grid">
                    <div>
                        <h4>Create Goal</h4>
                        <div class="form-group">
                            <label>Name:</label>
                            <input type="text" id="goalName" placeholder="Emergency Fund">
                        </div>
                        <div class="form-group">
                            <label>Target Amount:</label>
                            <input type="number" id="goalTargetAmount" placeholder="10000.00" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Current Amount:</label>
                            <input type="number" id="goalCurrentAmount" placeholder="5000.00" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Type:</label>
                            <select id="goalType" required>
                                <option value="">Select Type</option>
                                <option value="SAVINGS">Savings</option>
                                <option value="DEBT_PAYOFF">Debt Payoff</option>
                                <option value="EMERGENCY_FUND">Emergency Fund</option>
                                <option value="INVESTMENT">Investment</option>
                                <option value="PURCHASE">Purchase</option>
                                <option value="TRAVEL">Travel</option>
                                <option value="EDUCATION">Education</option>
                                <option value="OTHER">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Description:</label>
                            <textarea id="goalDescription" placeholder="Goal description"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Target Date:</label>
                            <input type="datetime-local" id="goalTargetDate">
                        </div>
                        <button onclick="createGoal()" class="btn-success">Create Goal</button>
                    </div>
                    <div>
                        <h4>Goal Operations</h4>
                        <button onclick="getGoals()" class="btn-success">Get All Goals</button>
                        <button onclick="getGoalById()" class="btn-warning">Get Goal by ID</button>
                        <input type="number" id="goalId" placeholder="Goal ID" style="margin-top: 10px;">
                    </div>
                </div>
                <div id="goalResponse" class="response-area" style="display: none;"></div>
            </div>

            <!-- Loading Spinner -->
            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p>Loading...</p>
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:8080/api';
        let jwtToken = localStorage.getItem('jwtToken');

        // Utility functions
        function showLoading() {
            document.getElementById('loading').style.display = 'block';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }

        function showResponse(elementId, data, isError = false) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.innerHTML = `<pre class="${isError ? 'status-error' : 'status-success'}">${JSON.stringify(data, null, 2)}</pre>`;
        }

        function getHeaders() {
            const headers = {
                'Content-Type': 'application/json'
            };
            if (jwtToken) {
                headers['Authorization'] = `Bearer ${jwtToken}`;
            }
            return headers;
        }

        async function makeRequest(url, options = {}) {
            try {
                showLoading();
                const response = await fetch(url, {
                    ...options,
                    headers: getHeaders()
                });
                
                let data;
                const contentType = response.headers.get('content-type');
                if (contentType && contentType.includes('application/json')) {
                    data = await response.json();
                } else {
                    const text = await response.text();
                    throw new Error(`Server returned non-JSON response: ${text}`);
                }
                
                if (!response.ok) {
                    throw new Error(data.message || data.error || `HTTP ${response.status}`);
                }
                
                return data;
            } catch (error) {
                throw error;
            } finally {
                hideLoading();
            }
        }

        // Authentication functions
        async function register() {
            try {
                const userData = {
                    email: document.getElementById('registerEmail').value,
                    password: document.getElementById('registerPassword').value,
                    firstName: document.getElementById('registerFirstName').value,
                    lastName: document.getElementById('registerLastName').value,
                    phoneNumber: document.getElementById('registerPhoneNumber')?.value || null,
                    dateOfBirth: document.getElementById('registerDateOfBirth')?.value || null,
                    currency: document.getElementById('registerCurrency')?.value || 'USD',
                    timeZone: document.getElementById('registerTimeZone')?.value || 'UTC'
                };

                const response = await makeRequest(`${API_BASE_URL}/auth/register`, {
                    method: 'POST',
                    body: JSON.stringify(userData)
                });

                if (response.data && response.data.token) {
                    jwtToken = response.data.token;
                    localStorage.setItem('jwtToken', jwtToken);
                    document.getElementById('jwtToken').textContent = jwtToken;
                    document.getElementById('tokenDisplay').style.display = 'block';
                }

                showResponse('authResponse', response);
            } catch (error) {
                showResponse('authResponse', { error: error.message }, true);
            }
        }

        async function login() {
            try {
                const userData = {
                    email: document.getElementById('loginEmail').value,
                    password: document.getElementById('loginPassword').value
                };

                const response = await makeRequest(`${API_BASE_URL}/auth/login`, {
                    method: 'POST',
                    body: JSON.stringify(userData)
                });

                if (response.data && response.data.token) {
                    jwtToken = response.data.token;
                    localStorage.setItem('jwtToken', jwtToken);
                    document.getElementById('jwtToken').textContent = jwtToken;
                    document.getElementById('tokenDisplay').style.display = 'block';
                }

                showResponse('authResponse', response);
            } catch (error) {
                showResponse('authResponse', { error: error.message }, true);
            }
        }

        function logout() {
            jwtToken = null;
            localStorage.removeItem('jwtToken');
            document.getElementById('tokenDisplay').style.display = 'none';
            document.getElementById('authResponse').style.display = 'none';
        }

        // Health check
        async function checkHealth() {
            try {
                const response = await makeRequest(`${API_BASE_URL}/health`);
                showResponse('healthResponse', response);
            } catch (error) {
                showResponse('healthResponse', { error: error.message }, true);
            }
        }

        // Category functions
        async function createCategory() {
            try {
                const categoryData = {
                    name: document.getElementById('categoryName').value,
                    description: document.getElementById('categoryDescription').value,
                    type: document.getElementById('categoryType').value
                };

                if (!categoryData.name) {
                    alert('Category name is required');
                    return;
                }

                if (!categoryData.type) {
                    alert('Category type is required');
                    return;
                }

                const response = await makeRequest(`${API_BASE_URL}/categories`, {
                    method: 'POST',
                    body: JSON.stringify(categoryData)
                });

                showResponse('categoryResponse', response);
                
                // Clear form on success
                if (response.success) {
                    document.getElementById('categoryName').value = '';
                    document.getElementById('categoryDescription').value = '';
                    document.getElementById('categoryType').value = '';
                }
            } catch (error) {
                showResponse('categoryResponse', { error: error.message }, true);
            }
        }

        async function getCategories() {
            try {
                const response = await makeRequest(`${API_BASE_URL}/categories`);
                showResponse('categoryResponse', response);
            } catch (error) {
                showResponse('categoryResponse', { error: error.message }, true);
            }
        }

        async function getCategoryById() {
            try {
                const categoryId = document.getElementById('categoryId').value;
                const response = await makeRequest(`${API_BASE_URL}/categories/${categoryId}`);
                showResponse('categoryResponse', response);
            } catch (error) {
                showResponse('categoryResponse', { error: error.message }, true);
            }
        }

        // Account functions
        async function createAccount() {
            try {
                const balance = parseFloat(document.getElementById('accountBalance').value);
                const accountData = {
                    name: document.getElementById('accountName').value,
                    type: document.getElementById('accountType').value,
                    initialBalance: balance,
                    currentBalance: balance
                };

                if (!accountData.name) {
                    alert('Account name is required');
                    return;
                }

                if (!accountData.type) {
                    alert('Account type is required');
                    return;
                }

                if (isNaN(balance)) {
                    alert('Valid balance is required');
                    return;
                }

                const response = await makeRequest(`${API_BASE_URL}/accounts`, {
                    method: 'POST',
                    body: JSON.stringify(accountData)
                });

                showResponse('accountResponse', response);
                
                // Clear form on success
                if (response.success) {
                    document.getElementById('accountName').value = '';
                    document.getElementById('accountBalance').value = '';
                    document.getElementById('accountType').value = 'CHECKING';
                }
            } catch (error) {
                showResponse('accountResponse', { error: error.message }, true);
            }
        }

        async function getAccounts() {
            try {
                const response = await makeRequest(`${API_BASE_URL}/accounts`);
                showResponse('accountResponse', response);
            } catch (error) {
                showResponse('accountResponse', { error: error.message }, true);
            }
        }

        async function getAccountById() {
            try {
                const accountId = document.getElementById('accountId').value;
                const response = await makeRequest(`${API_BASE_URL}/accounts/${accountId}`);
                showResponse('accountResponse', response);
            } catch (error) {
                showResponse('accountResponse', { error: error.message }, true);
            }
        }

        // Transaction functions
        async function createTransaction() {
            try {
                const transactionData = {
                    description: document.getElementById('transactionDescription').value,
                    amount: parseFloat(document.getElementById('transactionAmount').value),
                    accountId: parseInt(document.getElementById('transactionAccountId').value),
                    categoryId: parseInt(document.getElementById('transactionCategoryId').value),
                    type: document.getElementById('transactionType').value,
                    transactionDate: document.getElementById('transactionDate').value
                };

                if (!transactionData.description) {
                    alert('Transaction description is required');
                    return;
                }

                if (isNaN(transactionData.amount)) {
                    alert('Valid amount is required');
                    return;
                }

                if (!transactionData.type) {
                    alert('Transaction type is required');
                    return;
                }

                if (!transactionData.accountId) {
                    alert('Account ID is required');
                    return;
                }

                const response = await makeRequest(`${API_BASE_URL}/transactions`, {
                    method: 'POST',
                    body: JSON.stringify(transactionData)
                });

                showResponse('transactionResponse', response);
                
                // Clear form on success
                if (response.success) {
                    document.getElementById('transactionDescription').value = '';
                    document.getElementById('transactionAmount').value = '';
                    document.getElementById('transactionAccountId').value = '';
                    document.getElementById('transactionCategoryId').value = '';
                    document.getElementById('transactionType').value = '';
                    document.getElementById('transactionDate').value = '';
                }
            } catch (error) {
                showResponse('transactionResponse', { error: error.message }, true);
            }
        }

        async function getTransactions() {
            try {
                const response = await makeRequest(`${API_BASE_URL}/transactions`);
                showResponse('transactionResponse', response);
            } catch (error) {
                showResponse('transactionResponse', { error: error.message }, true);
            }
        }

        async function getTransactionById() {
            try {
                const transactionId = document.getElementById('transactionId').value;
                const response = await makeRequest(`${API_BASE_URL}/transactions/${transactionId}`);
                showResponse('transactionResponse', response);
            } catch (error) {
                showResponse('transactionResponse', { error: error.message }, true);
            }
        }

        async function getTransactionStats() {
            try {
                const response = await makeRequest(`${API_BASE_URL}/transactions/stats`);
                showResponse('transactionResponse', response);
            } catch (error) {
                showResponse('transactionResponse', { error: error.message }, true);
            }
        }

        // Budget functions
        async function createBudget() {
            try {
                const budgetData = {
                    name: document.getElementById('budgetName').value,
                    amount: parseFloat(document.getElementById('budgetAmount').value),
                    categoryId: parseInt(document.getElementById('budgetCategoryId').value),
                    period: document.getElementById('budgetPeriod').value
                };

                const response = await makeRequest(`${API_BASE_URL}/budgets`, {
                    method: 'POST',
                    body: JSON.stringify(budgetData)
                });

                showResponse('budgetResponse', response);
            } catch (error) {
                showResponse('budgetResponse', { error: error.message }, true);
            }
        }

        async function getBudgets() {
            try {
                const response = await makeRequest(`${API_BASE_URL}/budgets`);
                showResponse('budgetResponse', response);
            } catch (error) {
                showResponse('budgetResponse', { error: error.message }, true);
            }
        }

        async function getBudgetById() {
            try {
                const budgetId = document.getElementById('budgetId').value;
                const response = await makeRequest(`${API_BASE_URL}/budgets/${budgetId}`);
                showResponse('budgetResponse', response);
            } catch (error) {
                showResponse('budgetResponse', { error: error.message }, true);
            }
        }

        // Goal functions
        async function createGoal() {
            try {
                const goalData = {
                    name: document.getElementById('goalName').value,
                    targetAmount: parseFloat(document.getElementById('goalTargetAmount').value),
                    currentAmount: parseFloat(document.getElementById('goalCurrentAmount').value) || 0,
                    type: document.getElementById('goalType').value,
                    description: document.getElementById('goalDescription').value,
                    targetDate: document.getElementById('goalTargetDate').value
                };

                if (!goalData.name) {
                    alert('Goal name is required');
                    return;
                }

                if (isNaN(goalData.targetAmount)) {
                    alert('Valid target amount is required');
                    return;
                }

                if (!goalData.type) {
                    alert('Goal type is required');
                    return;
                }

                const response = await makeRequest(`${API_BASE_URL}/goals`, {
                    method: 'POST',
                    body: JSON.stringify(goalData)
                });

                showResponse('goalResponse', response);
                
                // Clear form on success
                if (response.success) {
                    document.getElementById('goalName').value = '';
                    document.getElementById('goalTargetAmount').value = '';
                    document.getElementById('goalCurrentAmount').value = '';
                    document.getElementById('goalType').value = '';
                    document.getElementById('goalDescription').value = '';
                    document.getElementById('goalTargetDate').value = '';
                }
            } catch (error) {
                showResponse('goalResponse', { error: error.message }, true);
            }
        }

        async function getGoals() {
            try {
                const response = await makeRequest(`${API_BASE_URL}/goals`);
                showResponse('goalResponse', response);
            } catch (error) {
                showResponse('goalResponse', { error: error.message }, true);
            }
        }

        async function getGoalById() {
            try {
                const goalId = document.getElementById('goalId').value;
                const response = await makeRequest(`${API_BASE_URL}/goals/${goalId}`);
                showResponse('goalResponse', response);
            } catch (error) {
                showResponse('goalResponse', { error: error.message }, true);
            }
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            if (jwtToken) {
                document.getElementById('jwtToken').textContent = jwtToken;
                document.getElementById('tokenDisplay').style.display = 'block';
            }
            
            // Set default date for transaction
            const now = new Date();
            now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
            document.getElementById('transactionDate').value = now.toISOString().slice(0,16);
            
            // Set default target date for goal (1 year from now)
            const oneYearFromNow = new Date();
            oneYearFromNow.setFullYear(oneYearFromNow.getFullYear() + 1);
            oneYearFromNow.setMinutes(oneYearFromNow.getMinutes() - oneYearFromNow.getTimezoneOffset());
            document.getElementById('goalTargetDate').value = oneYearFromNow.toISOString().slice(0,16);
            
            // Add password validation
            const passwordInput = document.getElementById('registerPassword');
            if (passwordInput) {
                passwordInput.addEventListener('input', function() {
                    const password = this.value;
                    const hasUpper = /[A-Z]/.test(password);
                    const hasLower = /[a-z]/.test(password);
                    const hasNumber = /\d/.test(password);
                    const hasSpecial = /[@$!%*?&]/.test(password);
                    const isLongEnough = password.length >= 8;
                    
                    let feedback = '';
                    if (!hasUpper) feedback += 'Missing uppercase letter. ';
                    if (!hasLower) feedback += 'Missing lowercase letter. ';
                    if (!hasNumber) feedback += 'Missing number. ';
                    if (!hasSpecial) feedback += 'Missing special character. ';
                    if (!isLongEnough) feedback += 'Must be at least 8 characters. ';
                    
                    const small = this.nextElementSibling;
                    if (feedback) {
                        small.style.color = '#dc3545';
                        small.textContent = feedback;
                    } else {
                        small.style.color = '#28a745';
                        small.textContent = 'Password meets requirements ‚úì';
                    }
                });
            }
        });
    </script>
</body>
</html> 